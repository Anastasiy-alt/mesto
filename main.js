(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._baseUrl=e.baseUrl,this._headers=e.headers}var n,r;return n=t,(r=[{key:"_check",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"GET"}).then((function(t){return e._check(t)}))}},{key:"addInitialCards",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify({name:e.title,link:e.link})}).then((function(e){return t._check(e)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"GET"}).then((function(t){return e._check(t)}))}},{key:"setUserInfo",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e.name,about:e.info})}).then((function(e){return t._check(e)}))}},{key:"addCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return e.json()})).then((function(e){return t._check(e)}))}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n){var r=t.data,o=t.handleCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),condition,this._title=r.name,this._link=r.link,this._cardSelector=n,this._handleCardClick=o}var t,r;return t=e,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".element").cloneNode(!0)}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._img=this._element.querySelector(".element__img"),this._imgName=this._element.querySelector(".element__name"),this._likeButton=this._element.querySelector(".element__like"),this._setEventListeners(),this._img.alt=this._title,this._img.src=this._link,this._imgName.textContent=this._title,this._element}},{key:"_handleClickLikeButton",value:function(){this._likeButton.classList.toggle("element__like_click")}},{key:"_handleClickDeleteButton",value:function(){this._element.remove()}},{key:"_setEventListeners",value:function(){var e=this;this._deleteButton=this._element.querySelector(".element__delete"),this._img.addEventListener("click",(function(){e._handleCardClick(e._title,e._link)})),this._deleteButton.addEventListener("click",(function(){e._handleClickDeleteButton()})),this._likeButton.addEventListener("click",(function(){e._handleClickLikeButton()}))}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=t,this._escClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._escClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._escClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popup.querySelector(".popup__close").addEventListener("click",(function(){e.close()})),this._popup.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&e.close()}))}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},c.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function f(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._submit=t,n._popupForm=n._popup.querySelector(".popup__form"),n._popupInput=n._popupForm.querySelectorAll(".popup__item"),n}return t=a,(n=[{key:"_getInputValues",value:function(){var e={};return this._popupInput.forEach((function(t){e[t.name]=t.value})),e}},{key:"setInputValues",value:function(e){this._inputList.forEach((function(t){t.value=e[t.name]}))}},{key:"setEventListeners",value:function(){var e=this;c(p(a.prototype),"setEventListeners",this).call(this),this._popupForm.addEventListener("submit",(function(t){t.preventDefault(),e._submit(e._getInputValues())}))}},{key:"close",value:function(){c(p(a.prototype),"close",this).call(this),this._popupForm.reset()}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i);function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t,n){var r=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderer=r,this._container=n}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._container.prepend(e)}},{key:"renderItems",value:function(e){var t=this;e.forEach((function(e){t._renderer(e)}))}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=b(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},v.apply(this,arguments)}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function k(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(r);if(o){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return k(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._imgLink=t._popup.querySelector(".popup__img"),t._imgName=t._popup.querySelector(".popup__info-img"),t}return t=a,(n=[{key:"open",value:function(e,t){this._imgLink.src=t,this._imgLink.alt=e,this._imgName.textContent=e,v(w(a.prototype),"open",this).call(this)}}])&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(i);function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=function(){function e(t){var n=t.userName,r=t.userInfo,o=t.userAvatar;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userName=n,this._userInfo=r,this._userAvatar=o}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){var e={};return e.name=this._userName.textContent,e.info=this._userInfo.textContent,e.avatar=this._userAvatar.src,e}},{key:"setUserInfo",value:function(e){this._userName.textContent=e.name,this._userInfo.textContent=e.about,this._userAvatar.src=e.avatar}}])&&S(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),j(this,"_showError",(function(e,t){var n=r._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(r._form.inputErrorClass),n.textContent=t,n.classList.add(r._form.errorClass)})),j(this,"_hideError",(function(e){var t=r._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(r._form.inputErrorClass),t.classList.remove(r._form.errorClass),t.textContent=" "})),j(this,"_checkInputValidity",(function(e){e.validity.valid?r._hideError(e):r._showError(e,e.validationMessage)})),this._form=t,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(".popup__item")),this._buttonElement=this._formElement.querySelector(this._form.submitButtonSelector)}var t,n;return t=e,(n=[{key:"_setEventListeners",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e.toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners(),this._formElement.addEventListener("submit",(function(e){e.preventDefault()}))}},{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"makeButtonDisabled",value:function(){this._buttonElement.classList.add(this._form.inactiveButtonClass),this._buttonElement.disabled=!0}},{key:"toggleButtonState",value:function(){this._hasInvalidInput()?this.makeButtonDisabled():(this._buttonElement.classList.remove(this._form.inactiveButtonClass),this._buttonElement.disabled=!1)}},{key:"resetValidation",value:function(){var e=this;this.toggleButtonState(),this._inputList.forEach((function(t){e._hideError(t)}))}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),P=document.querySelector(".profile__edit-button"),I=document.querySelector(".popup_for_edit"),q=document.querySelector(".popup_for_add"),B=document.querySelector("[name=name]"),T=document.querySelector("[name=info]"),U=document.querySelector(".profile__name"),A=document.querySelector(".profile__info"),R=document.querySelector(".profile__add-button"),x=document.querySelector(".elements"),N=document.querySelector(".popup_for_img"),V=document.querySelector(".profile__avatar"),D={};function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}document.querySelector(".popup_for_delete"),document.querySelector(".popup_for_avatar");var J=document.querySelector(".profile__cover-hover"),G=document.querySelector(".popup__item_input_link-avatar");J.addEventListener("click",(function(){D["form-avatar"].resetValidation();var e=H.getUserInfo();G.value=e.avatar,$.open()}));var M=new t({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-46",headers:{authorization:"4ab555e1-39a0-48e6-8593-6e8a4a84e28f","Content-Type":"application/json"}}),z=new d({renderer:function(e){z.addItem(W(e))}},x),H=new O({userName:U,userInfo:A,userAvatar:V});Promise.all([M.getUserInfo(),M.getInitialCards()]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1];H.setUserInfo(o),z.renderItems(i)})).catch((function(e){console.log("Ошибка: ".concat(e))}));var $=new h(I,(function(e){M.setUserInfo(e).then((function(e){H.setUserInfo(e),$.close()}))}));$.setEventListeners(),P.addEventListener("click",(function(){D["form-info"].resetValidation();var e=H.getUserInfo();T.value=e.info,B.value=e.name,$.open()}));var K=new E(N);K.setEventListeners();var Q,W=function(e){return new r({data:e,handleCardClick:function(e,t){K.open(e,t)}},".img-template").generateCard()},X=new h(q,(function(e){z.addItem(W(e)),X.close()}));X.setEventListeners(),R.addEventListener("click",(function(){D["form-add"].resetValidation(),X.open()})),Q={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_type_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll(Q.formSelector)).forEach((function(e){var t=new L(Q,e),n=e.getAttribute("name");D[n]=t,t.enableValidation()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQzNCQSxFQUFVRyxrQkFDWCxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9wYWdlcy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5fYmFzZVVybCA9IG9wdGlvbnMuYmFzZVVybDtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgICB9XG4gICAgX2NoZWNrKHJlcykge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICAvLyDQtdGB0LvQuCDQvtGI0LjQsdC60LAsINC+0YLQutC70L7QvdGP0LXQvCDQv9GA0L7QvNC40YFcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGDQntGI0LjQsdC60LA6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9XG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJ1xuICAgICAgICB9KVxuICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2socmVzKSlcbiAgICB9XG5cbiAgICBhZGRJbml0aWFsQ2FyZHMoY2FyZERhdGEpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgIG5hbWU6IGNhcmREYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgIGxpbms6IGNhcmREYXRhLmxpbmtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlcyA9PiB0aGlzLl9jaGVjayhyZXMpKVxuXG4gICAgfVxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJ1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrKHJlcykpXG4gICAgfVxuXG4gICAgc2V0VXNlckluZm8odXNlckRhdGEpIHtcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgICAgICAgIG1ldGhvZDogJ1BBVENIJyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgIGFib3V0OiB1c2VyRGF0YS5pbmZvXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHRoaXMuX2NoZWNrKHJlcykpXG4gICAgfVxuXG4gICAgYWRkQ2FyZChjYXJkRGF0YSkge1xuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgbmFtZTogY2FyZERhdGEubmFtZSxcbiAgICAgICAgICAgICAgICBsaW5rOiBjYXJkRGF0YS5saW5rXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXG4gICAgICAgICAgICAudGhlbihyZXMgPT4gdGhpcy5fY2hlY2socmVzKSk7XG4gICAgfVxuXG59XG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGhhbmRsZUNhcmRDbGljayB9LCBjYXJkU2VsZWN0b3IpIHtcbiAgICBpZiAoY29uZGl0aW9uKSB7XG4gICAgICBcbiAgICB9IGVsc2Uge1xuICAgICAgXG4gICAgfVxuICAgIHRoaXMuX3RpdGxlID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50JylcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5faW1nID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faW1nJyk7XG4gICAgdGhpcy5faW1nTmFtZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX25hbWUnKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZScpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5faW1nLmFsdCA9IHRoaXMuX3RpdGxlO1xuICAgIHRoaXMuX2ltZy5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2ltZ05hbWUudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxuXG4gIF9oYW5kbGVDbGlja0xpa2VCdXR0b24oKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19saWtlX2NsaWNrJyk7XG4gIH1cblxuICBfaGFuZGxlQ2xpY2tEZWxldGVCdXR0b24oKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19kZWxldGUnKTtcbiAgICB0aGlzLl9pbWcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fdGl0bGUsIHRoaXMuX2xpbmspXG4gICAgfSk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2xpY2tEZWxldGVCdXR0b24oKTtcbiAgICB9KTtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2xpY2tMaWtlQnV0dG9uKCk7XG4gICAgfSk7XG4gIH07XG59XG5cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xuICAgICAgICB0aGlzLl9wb3B1cCA9IHBvcHVwO1xuICAgICAgICB0aGlzLl9lc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9lc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fZXNjQ2xvc2UpO1xuICAgIH1cblxuICAgIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICAgICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgY29uc3QgY2xvc2VCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlJyk7XG4gICAgICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9vcGVuZWQnKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzdWJtaXQpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3N1Ym1pdCA9IHN1Ym1pdDtcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtJyk7XG4gICAgICAgIHRoaXMuX3BvcHVwSW5wdXQgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pdGVtJyk7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgICBjb25zdCBpbnB1dERhdGEgPSB7fTtcbiAgICAgICAgdGhpcy5fcG9wdXBJbnB1dC5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgICAgICAgIGlucHV0RGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGlucHV0RGF0YTtcbiAgICB9XG5cblxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgIC8vINGC0YPRgiDQstGB0YLQsNCy0LvRj9C10Lwg0LIgYHZhbHVlYCDQuNC90L/Rg9GC0LAg0LTQsNC90L3Ri9C1INC40Lcg0L7QsdGK0LXQutGC0LAg0L/QviDQsNGC0YDQuNCx0YPRgtGDIGBuYW1lYCDRjdGC0L7Qs9C+INC40L3Qv9GD0YLQsFxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xuICAgIH0pO1xuICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih7cmVuZGVyZXIgfSwgY29udGFpbmVyKSB7XG4gICAgICAgIC8vIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcbiAgICB9XG5cbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gICAgfVxuXG4gICAgcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgICAgICAgaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICB9XG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2ltZ0xpbmsgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltZycpO1xuICAgICAgICB0aGlzLl9pbWdOYW1lID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbmZvLWltZycpO1xuICAgIH1cblxuICAgIG9wZW4obmFtZSwgbGluaykge1xuICAgICAgICB0aGlzLl9pbWdMaW5rLnNyYyA9IGxpbms7XG4gICAgICAgIHRoaXMuX2ltZ0xpbmsuYWx0ID0gbmFtZTtcbiAgICAgICAgdGhpcy5faW1nTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgIHN1cGVyLm9wZW4oKTtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICAgIGNvbnN0cnVjdG9yKHsgdXNlck5hbWUsIHVzZXJJbmZvLCB1c2VyQXZhdGFyIH0pIHtcbiAgICAgICAgdGhpcy5fdXNlck5hbWUgPSB1c2VyTmFtZTtcbiAgICAgICAgdGhpcy5fdXNlckluZm8gPSB1c2VySW5mbztcbiAgICAgICAgdGhpcy5fdXNlckF2YXRhciA9IHVzZXJBdmF0YXI7XG4gICAgfVxuXG4gICAgZ2V0VXNlckluZm8oKSB7XG4gICAgICAgIGNvbnN0IHVzZXJEYXRhID0ge307XG4gICAgICAgIHVzZXJEYXRhWyduYW1lJ10gPSB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudDtcbiAgICAgICAgdXNlckRhdGFbJ2luZm8nXSA9IHRoaXMuX3VzZXJJbmZvLnRleHRDb250ZW50O1xuICAgICAgICB1c2VyRGF0YVsnYXZhdGFyJ10gPSB0aGlzLl91c2VyQXZhdGFyLnNyYztcbiAgICAgICAgcmV0dXJuIHVzZXJEYXRhO1xuXG4gICAgfVxuXG4gICAgc2V0VXNlckluZm8odXNlckRhdGEpIHtcbiAgICAgICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xuICAgICAgICB0aGlzLl91c2VySW5mby50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xuICAgICAgICB0aGlzLl91c2VyQXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcbiAgICB9XG5cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICBjb25zdHJ1Y3Rvcihmb3JtQ2xhc3NMaXN0LCBmb3JtKSB7XG4gICAgICAgIHRoaXMuX2Zvcm0gPSBmb3JtQ2xhc3NMaXN0O1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm07XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pdGVtJykpO1xuICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9mb3JtLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgICB9O1xuXG4gICAgLy8g0KTRg9C90LrRhtC40Y8sINC60L7RgtC+0YDQsNGPINC00L7QsdCw0LLQu9GP0LXRgiDQutC70LDRgdGBINGBINC+0YjQuNCx0LrQvtC5XG4gICAgX3Nob3dFcnJvciA9IChpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkgPT4ge1xuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Zvcm0uaW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9mb3JtLmVycm9yQ2xhc3MpO1xuICAgIH07XG5cbiAgICAvLyDQpNGD0L3QutGG0LjRjywg0LrQvtGC0L7RgNCw0Y8g0YPQtNCw0LvRj9C10YIg0LrQu9Cw0YHRgSDRgSDQvtGI0LjQsdC60L7QuVxuICAgIF9oaWRlRXJyb3IgPSAoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZm9ybS5pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9mb3JtLmVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIiBcIjtcbiAgICB9O1xuXG4gICAgLy8g0KTRg9C90LrRhtC40Y8sINC60L7RgtC+0YDQsNGPINC/0YDQvtCy0LXRgNGP0LXRgiDQstCw0LvQuNC00L3QvtGB0YLRjCDQv9C+0LvRj1xuICAgIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgICAgICB0aGlzLl9zaG93RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5faGlkZUVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9KVxuICAgIH07XG5cbiAgICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAvL9GE0YPQvdC60YbQuNGPLCDQutC+0YLQvtGA0LDRjyDQtNC10LvQsNC10YIg0LrQvdC+0L/QutGDINC90LXQsNC60YLQuNCy0L3QvtC5IFxuICAgIG1ha2VCdXR0b25EaXNhYmxlZCgpIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Zvcm0uaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlXG4gICAgfTtcblxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgICAgICAgIHRoaXMubWFrZUJ1dHRvbkRpc2FibGVkKClcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9mb3JtLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG59IiwiZXhwb3J0IGNvbnN0IGVkaXRCdG5Qcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XG5leHBvcnQgY29uc3QgcG9wdXBFZGl0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9mb3JfZWRpdCcpO1xuZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9mb3JfYWRkJyk7XG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW25hbWU9bmFtZV0nKTtcbmV4cG9ydCBjb25zdCBpbmZvSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbbmFtZT1pbmZvXScpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX25hbWUnKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlSW5mbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbmZvJyk7XG5leHBvcnQgY29uc3QgYWRkQnRuSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xuZXhwb3J0IGNvbnN0IGJsb2NrQ2FyZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudHMnKTtcbmV4cG9ydCBjb25zdCBpbWFnZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2Zvcl9pbWcnKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhcicpO1xuXG5leHBvcnQgY29uc3QgcG9wdXBWYWxpZGF0aW9uID0ge1xuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19idXR0b24nLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl90eXBlX2Rpc2FibGVkJyxcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxuICBlcnJvckNsYXNzOiAncG9wdXBfX2lucHV0LWVycm9yX2FjdGl2ZSdcbn07XG5leHBvcnQgY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTsiLCJpbXBvcnQgQXBpIGZyb20gJy4uL2NvbXBvbmVudHMvQXBpLmpzJztcbmltcG9ydCBDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMnO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzJztcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcbmltcG9ydCAnLi9pbmRleC5jc3MnO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJztcbmltcG9ydCB7XG4gIGVkaXRCdG5Qcm9maWxlLCBwb3B1cEVkaXRQcm9maWxlLCBwb3B1cEFkZENhcmQsIG5hbWVJbnB1dCxcbiAgaW5mb0lucHV0LCBwcm9maWxlTmFtZSwgcHJvZmlsZUluZm8sIGFkZEJ0bkltYWdlLFxuICBibG9ja0NhcmRzLCBpbWFnZVBvcHVwLCBwb3B1cFZhbGlkYXRpb24sXG4gIGZvcm1WYWxpZGF0b3JzLCBwcm9maWxlQXZhdGFyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuY29uc3QgcG9wdXBEZWxldGVDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX2Zvcl9kZWxldGUnKTtcbmNvbnN0IHBvcHVwRWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9mb3JfYXZhdGFyJyk7XG5jb25zdCBlZGl0QXZhdGFyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2NvdmVyLWhvdmVyJyk7XG5jb25zdCBhdmF0YXJJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faXRlbV9pbnB1dF9saW5rLWF2YXRhcicpO1xuXG5lZGl0QXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1snZm9ybS1hdmF0YXInXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpXG4gIGF2YXRhcklucHV0LnZhbHVlID0gdXNlckRhdGEuYXZhdGFyO1xuICBoYW5kbGVFZGl0Rm9ybS5vcGVuKCk7XG59KVxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogJ2h0dHBzOi8vbWVzdG8ubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtNDYnLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogJzRhYjU1NWUxLTM5YTAtNDhlNi04NTkzLTZlOGE0YTg0ZTI4ZicsXG4gICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICB9XG59KTtcblxuY29uc3Qg0YFhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKHtcbiAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAg0YFhcmRzTGlzdC5hZGRJdGVtKGNyZWF0ZUNhcmQoaXRlbSkpO1xuICB9XG59LCBibG9ja0NhcmRzKTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICB1c2VyTmFtZTogcHJvZmlsZU5hbWUsXG4gIHVzZXJJbmZvOiBwcm9maWxlSW5mbyxcbiAgdXNlckF2YXRhcjogcHJvZmlsZUF2YXRhclxufSk7XG5cblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcbiAgLnRoZW4oKFt1c2VyRGF0YSwgaW5pdGlhbENhcmRzXSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcbiAgICDRgWFyZHNMaXN0LnJlbmRlckl0ZW1zKGluaXRpYWxDYXJkcyk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICBjb25zb2xlLmxvZyhg0J7RiNC40LHQutCwOiAke2Vycm9yfWApO1xuICB9KTtcblxuY29uc3Qgc3VibWl0RWRpdCA9IChkYXRhRWRpdEZvcm0pID0+IHtcbiAgYXBpLnNldFVzZXJJbmZvKGRhdGFFZGl0Rm9ybSlcbiAgLnRoZW4oKGRhdGFFZGl0Rm9ybSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oZGF0YUVkaXRGb3JtKTtcbiAgICAgIGhhbmRsZUVkaXRGb3JtLmNsb3NlKCk7XG4gICAgfVxuICApXG59XG5cbmNvbnN0IGhhbmRsZUVkaXRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBFZGl0UHJvZmlsZSwgc3VibWl0RWRpdCk7XG5oYW5kbGVFZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5lZGl0QnRuUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgZm9ybVZhbGlkYXRvcnNbJ2Zvcm0taW5mbyddLnJlc2V0VmFsaWRhdGlvbigpO1xuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKClcbiAgaW5mb0lucHV0LnZhbHVlID0gdXNlckRhdGEuaW5mbztcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgaGFuZGxlRWRpdEZvcm0ub3BlbigpO1xufSk7XG5cbmNvbnN0IHpvb21JbWcgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoaW1hZ2VQb3B1cCk7XG56b29tSW1nLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGNyZWF0ZUNhcmQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAge1xuICAgICAgZGF0YTogZGF0YSxcbiAgICAgIGhhbmRsZUNhcmRDbGljazogKG5hbWUsIGxpbmspID0+IHtcbiAgICAgICAgem9vbUltZy5vcGVuKG5hbWUsIGxpbmspO1xuICAgICAgfVxuICAgIH0sICcuaW1nLXRlbXBsYXRlJyk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufTtcblxuY29uc3Qgc3VibWl0QWRkID0gKGRhdGFBZGRGb3JtKSA9PiB7XG4gINGBYXJkc0xpc3QuYWRkSXRlbShjcmVhdGVDYXJkKGRhdGFBZGRGb3JtKSk7XG4gIGhhbmRsZUFkZENhcmRQb3B1cC5jbG9zZSgpO1xufTtcblxuY29uc3QgaGFuZGxlQWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0ocG9wdXBBZGRDYXJkLCBzdWJtaXRBZGQpO1xuaGFuZGxlQWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmFkZEJ0bkltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1snZm9ybS1hZGQnXS5yZXNldFZhbGlkYXRpb24oKTtcbiAgaGFuZGxlQWRkQ2FyZFBvcHVwLm9wZW4oKTtcbn0pXG5cblxuXG4vLyDRgWFyZHNMaXN0LnJlbmRlckl0ZW1zKGluaXRpYWxDYXJkcyk7XG5cbi8vINCS0LrQu9GO0YfQtdC90LjQtSDQstCw0LvQuNC00LDRhtC40LhcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAocG9wdXBWYWxpZGF0aW9uKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHBvcHVwVmFsaWRhdGlvbi5mb3JtU2VsZWN0b3IpKVxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHBvcHVwVmFsaWRhdGlvbiwgZm9ybUVsZW1lbnQpXG4gICAgLy8g0L/QvtC70YPRh9Cw0LXQvCDQtNCw0L3QvdGL0LUg0LjQtyDQsNGC0YDQuNCx0YPRgtCwIGBuYW1lYCDRgyDRhNC+0YDQvNGLXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ25hbWUnKVxuICAgIC8vINCy0L7RgiDRgtGD0YIg0LIg0L7QsdGK0LXQutGCINC30LDQv9C40YHRi9Cy0LDQtdC8INC/0L7QtCDQuNC80LXQvdC10Lwg0YTQvtGA0LzRi1xuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24ocG9wdXBWYWxpZGF0aW9uKTsiXSwibmFtZXMiOlsiQXBpIiwib3B0aW9ucyIsInRoaXMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwiX2NoZWNrIiwiY2FyZERhdGEiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm5hbWUiLCJ0aXRsZSIsImxpbmsiLCJ1c2VyRGF0YSIsImFib3V0IiwiaW5mbyIsIkNhcmQiLCJjYXJkU2VsZWN0b3IiLCJkYXRhIiwiaGFuZGxlQ2FyZENsaWNrIiwiY29uZGl0aW9uIiwiX3RpdGxlIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfZWxlbWVudCIsIl9nZXRUZW1wbGF0ZSIsIl9pbWciLCJfaW1nTmFtZSIsIl9saWtlQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWx0Iiwic3JjIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW1vdmUiLCJfZGVsZXRlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVDbGlja0RlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVDbGlja0xpa2VCdXR0b24iLCJQb3B1cCIsInBvcHVwIiwiX3BvcHVwIiwiX2VzY0Nsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsImFkZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsInBvcHVwU2VsZWN0b3IiLCJzdWJtaXQiLCJfc3VibWl0IiwiX3BvcHVwRm9ybSIsIl9wb3B1cElucHV0IiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0RGF0YSIsImZvckVhY2giLCJpbnB1dCIsInZhbHVlIiwiX2lucHV0TGlzdCIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsIlNlY3Rpb24iLCJjb250YWluZXIiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJlbGVtZW50IiwicHJlcGVuZCIsIml0ZW1zIiwiaXRlbSIsIlBvcHVwV2l0aEltYWdlIiwiX2ltZ0xpbmsiLCJVc2VySW5mbyIsInVzZXJOYW1lIiwidXNlckluZm8iLCJ1c2VyQXZhdGFyIiwiX3VzZXJOYW1lIiwiX3VzZXJJbmZvIiwiX3VzZXJBdmF0YXIiLCJhdmF0YXIiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybUNsYXNzTGlzdCIsImZvcm0iLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJfZm9ybUVsZW1lbnQiLCJpZCIsIl9mb3JtIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUVycm9yIiwiX3Nob3dFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiQXJyYXkiLCJmcm9tIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInNvbWUiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJfaGFzSW52YWxpZElucHV0IiwibWFrZUJ1dHRvbkRpc2FibGVkIiwiZWRpdEJ0blByb2ZpbGUiLCJwb3B1cEVkaXRQcm9maWxlIiwicG9wdXBBZGRDYXJkIiwibmFtZUlucHV0IiwiaW5mb0lucHV0IiwicHJvZmlsZU5hbWUiLCJwcm9maWxlSW5mbyIsImFkZEJ0bkltYWdlIiwiYmxvY2tDYXJkcyIsImltYWdlUG9wdXAiLCJwcm9maWxlQXZhdGFyIiwiZm9ybVZhbGlkYXRvcnMiLCJlZGl0QXZhdGFyQnRuIiwiYXZhdGFySW5wdXQiLCJnZXRVc2VySW5mbyIsImhhbmRsZUVkaXRGb3JtIiwib3BlbiIsImFwaSIsImF1dGhvcml6YXRpb24iLCLRgWFyZHNMaXN0IiwiYWRkSXRlbSIsImNyZWF0ZUNhcmQiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJpbml0aWFsQ2FyZHMiLCJzZXRVc2VySW5mbyIsInJlbmRlckl0ZW1zIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJkYXRhRWRpdEZvcm0iLCJzZXRFdmVudExpc3RlbmVycyIsInpvb21JbWciLCJwb3B1cFZhbGlkYXRpb24iLCJnZW5lcmF0ZUNhcmQiLCJoYW5kbGVBZGRDYXJkUG9wdXAiLCJkYXRhQWRkRm9ybSIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJmb3JtRWxlbWVudCIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=